import streamlit as st
import pandas as pd

# ----------------------
# 📦 โหลดข้อมูลร้านอาหาร
# ----------------------
# ตัวอย่างข้อมูลเบื้องต้น (คุณเปลี่ยนเป็นข้อมูลจริงได้)
data = pd.DataFrame([
    {"ชื่อร้าน": "ข้าวขาหมูโกเอก", "ประเภท": "อาหารจานเดียว", "ราคา": 50, "พื้นที่": "ประตู 1", "เวลา": ["กลางวัน", "เย็น"]},
    {"ชื่อร้าน": "ปิ้งย่างลุงหมี", "ประเภท": "ปิ้งย่าง", "ราคา": 189, "พื้นที่": "ประตู 4", "เวลา": ["เย็น"]},
    {"ชื่อร้าน": "โซลชาบู", "ประเภท": "ชาบู", "ราคา": 299, "พื้นที่": "ประตู 4", "เวลา": ["กลางวัน", "เย็น"]},
    {"ชื่อร้าน": "อาหารตามสั่งป้าหน่อย", "ประเภท": "อาหารตามสั่ง", "ราคา": 45, "พื้นที่": "ใน มทส.", "เวลา": ["เช้า", "กลางวัน"]},
    {"ชื่อร้าน": "ร้านส้มตำเจ๊แต๋ว", "ประเภท": "อาหารอีสาน", "ราคา": 60, "พื้นที่": "ประตู 1", "เวลา": ["กลางวัน"]}
])

# ----------------------
# 🎯 ส่วนรับค่าจากผู้ใช้
# ----------------------
st.title("🍛 แนะนำร้านอาหารรอบ มทส.")

st.subheader("เลือกลักษณะร้านอาหารที่คุณต้องการ")

# 1. ประเภทอาหาร
food_type = st.selectbox(
    "คุณอยากทานอาหารประเภทใด?",
    sorted(data["ประเภท"].unique())
)

# 2. งบประมาณ
budget = st.selectbox(
    "งบประมาณต่อมื้อ (บาท)",
    ["ไม่เกิน 50", "50–100", "100–200", "200+"]
)

# 3. ช่วงเวลา
time = st.selectbox(
    "คุณจะไปทานในช่วงเวลาใด?",
    ["เช้า", "กลางวัน", "เย็น"]
)

# 4. พื้นที่
area = st.selectbox(
    "คุณสะดวกไปทานที่บริเวณใด?",
    sorted(data["พื้นที่"].unique())
)

# ----------------------
# 🔍 เงื่อนไขการกรองร้านอาหาร
# ----------------------

# แปลงงบประมาณเป็นตัวเลข
def budget_to_range(budget_label):
    if budget_label == "ไม่เกิน 50":
        return 0, 50
    elif budget_label == "50–100":
        return 50, 100
    elif budget_label == "100–200":
        return 100, 200
    else:
        return 200, 10000

min_price, max_price = budget_to_range(budget)

filtered = data[
    (data["ประเภท"] == food_type) &
    (data["ราคา"] >= min_price) & (data["ราคา"] <= max_price) &
    (data["พื้นที่"] == area) &
    (data["เวลา"].apply(lambda x: time in x))
]

# ----------------------
# ✅ แสดงผลลัพธ์
# ----------------------
st.subheader("📍 ร้านอาหารที่แนะนำ:")
if not filtered.empty:
    for i, row in filtered.iterrows():
        st.markdown(f"- **{row['ชื่อร้าน']}** ({row['ประเภท']}, ฿{row['ราคา']}, {row['พื้นที่']})")
else:
    st.info("ไม่พบร้านอาหารที่ตรงกับเงื่อนไข ลองเปลี่ยนตัวเลือกดูนะ")

